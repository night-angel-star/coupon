{"version":3,"file":"static/js/106.6c6dd91c.chunk.js","mappings":"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","sources":["components/CouponManage/DataTable.jsx","pages/dashboard/CouponManage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Table, Space, Popconfirm, message, Spin, Image, Switch } from \"antd\";\r\nimport { EditTwoTone, DeleteTwoTone } from \"@ant-design/icons\";\r\nimport { useSelector } from \"react-redux\";\r\n// import { useLocation } from \"react-router-dom\";\r\nimport { removeData } from \"../../redux/actions/data\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { getData, clearData, addData } from \"../../redux/actions/data\";\r\nimport { showDrawer } from \"../../redux/actions/drawer\";\r\nimport { clearFilter } from \"../../redux/actions/search\";\r\nimport API_URL from \"../../services/API\";\r\n\r\nconst EditableDataTable = (props) => {\r\n  const dispatch = useDispatch();\r\n  const [loading, setLoading] = useState(false);\r\n  const { columns, showAction } = props;\r\n  // const { pathname } = useLocation();\r\n  // const pageName = pathname.substring(1, pathname.length);\r\n  const pageName = useSelector((state) => state.route.name);\r\n  const permission = useSelector((state) =>\r\n    state.auth.isLoggedIn ? state.auth.user.permission : {}\r\n  );\r\n  const level = useSelector((state) =>\r\n    state.auth.isLoggedIn ? state.auth.user.level : -1\r\n  );\r\n\r\n  const realPermissionForEdit = permission[pageName]\r\n    ? permission[pageName].edit\r\n    : level;\r\n  const realPermissionForDel = permission[pageName]\r\n    ? permission[pageName].del\r\n    : level;\r\n  const { key, value } = useSelector((state) => state.search);\r\n\r\n  const data = useSelector((state) => state.data.data);\r\n  const [filteredData, setFilteredData] = useState(data);\r\n  useEffect(() => {\r\n    if (key.length > 0) {\r\n      setFilteredData(\r\n        data.filter((d) => {\r\n          if (d[key]) {\r\n            if (typeof d[key] === \"string\") {\r\n              return d[key].toLowerCase().indexOf(value.toLowerCase()) > -1;\r\n            } else {\r\n              return d[key].toString() === value ? true : false;\r\n            }\r\n          } else {\r\n            return false;\r\n          }\r\n        })\r\n      );\r\n    } else {\r\n      setFilteredData(data);\r\n    }\r\n  }, [key, value, data]);\r\n\r\n  useEffect(() => {\r\n    if (pageName) {\r\n      setLoading(true);\r\n\r\n      const getHandler = async () => {\r\n        dispatch(clearData());\r\n        dispatch(getData(pageName))\r\n          .then(() => {\r\n            setLoading(false);\r\n          })\r\n          .catch(() => {\r\n            setLoading(false);\r\n          });\r\n      };\r\n      dispatch(clearFilter());\r\n      getHandler();\r\n    }\r\n  }, [dispatch, pageName]);\r\n\r\n  const onSwitch = (item) => {\r\n    setLoading(true);\r\n    dispatch(\r\n      addData(\"coupon\", { ...item, status: 1 - item.status }, true)\r\n    ).then(() => {\r\n      setLoading(false);\r\n    });\r\n  };\r\n\r\n  const editButtonHandler = (id) => {\r\n    dispatch(showDrawer({ id: id, title: `Edit ${pageName}`, show: true }));\r\n  };\r\n  const deleteButtonHandler = (id) => {\r\n    if (realPermissionForDel === 1) {\r\n      setLoading(true);\r\n      dispatch(removeData(pageName, { id }))\r\n        .then(() => setLoading(false))\r\n        .catch(() => {\r\n          message.error(\"Problem\");\r\n          setLoading(false);\r\n        });\r\n    } else {\r\n      message.open({ type: \"warning\", content: \"You have no permission\" });\r\n    }\r\n  };\r\n  const columnWithControl = [\r\n    ...columns,\r\n    {\r\n      title: \"Image\",\r\n      key: \"image\",\r\n      render: (item) => (\r\n        <Space size=\"small\">\r\n          <Image\r\n            width={50}\r\n            src={`${API_URL}uploads/${item.image1}`}\r\n            alt={item.image1}\r\n          />\r\n          {item.image2 && (\r\n            <Image\r\n              width={50}\r\n              src={`${API_URL}uploads/${item.image2}`}\r\n              alt={item.image2}\r\n            />\r\n          )}\r\n          {item.image3 && (\r\n            <Image\r\n              width={50}\r\n              src={`${API_URL}uploads/${item.image3}`}\r\n              alt={item.image3}\r\n            />\r\n          )}\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: \"Action\",\r\n      key: \"action\",\r\n      render: (item) => (\r\n        <Space size=\"middle\">\r\n          {realPermissionForEdit === 1 && (\r\n            <EditTwoTone\r\n              className=\"cursor-pointer\"\r\n              onClick={() => editButtonHandler(item.key)}\r\n            />\r\n          )}\r\n          <Popconfirm\r\n            placement=\"left\"\r\n            title=\"Sure to delete?\"\r\n            onConfirm={() => deleteButtonHandler(item.key)}\r\n            okText=\"Yes\"\r\n            cancelText=\"No\"\r\n          >\r\n            {realPermissionForDel === 1 && (\r\n              <DeleteTwoTone\r\n                twoToneColor=\"#eb2f96\"\r\n                className=\"cursor-pointer\"\r\n              />\r\n            )}\r\n          </Popconfirm>\r\n          {level === 1 && (\r\n            <Switch\r\n              checkedChildren=\"Enable\"\r\n              unCheckedChildren=\"Disable\"\r\n              checked={item.status}\r\n              style={{ marginLeft: \"20px\" }}\r\n              onChange={() => onSwitch(item)}\r\n            />\r\n          )}\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n  return (\r\n    <Spin spinning={loading}>\r\n      <Table\r\n        columns={showAction ? columnWithControl : columns}\r\n        dataSource={filteredData}\r\n      />\r\n    </Spin>\r\n  );\r\n};\r\nexport default EditableDataTable;\r\n","import DataTable from \"../../components/CouponManage/DataTable\";\r\nimport { Row, Space, Button } from \"antd\";\r\nimport { PlusOutlined } from \"@ant-design/icons\";\r\nimport Search from \"../../components/Search\";\r\nimport tableColumns from \"../../constant/tableColumns\";\r\nimport { showDrawer } from \"../../redux/actions/drawer\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nexport const CouponManage = () => {\r\n  const dispatch = useDispatch();\r\n  const level = useSelector((state) =>\r\n    state.auth.isLoggedIn ? state.auth.user.level : {}\r\n  );\r\n  const columns = tableColumns.coupon;\r\n  const searchFields = columns.reduce(\r\n    (accumulator, currentValue) => [...accumulator, currentValue.key],\r\n    []\r\n  );\r\n  const openDrawer = () => {\r\n    dispatch(\r\n      showDrawer({\r\n        id: 0,\r\n        title: \"Add Goods\",\r\n        show: true,\r\n      })\r\n    );\r\n  };\r\n  return (\r\n    <div>\r\n      <Row justify={\"end\"} className=\"p-2\">\r\n        <Space>\r\n          <Search fields={searchFields} />\r\n          {level === 1 && (\r\n            <Button type=\"primary\" icon={<PlusOutlined />} onClick={openDrawer}>\r\n              Add\r\n            </Button>\r\n          )}\r\n        </Space>\r\n      </Row>\r\n      <DataTable columns={columns} showAction />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CouponManage;\r\n"],"names":["props","dispatch","useDispatch","_useState","useState","_useState2","_slicedToArray","loading","setLoading","columns","showAction","pageName","useSelector","state","route","name","permission","auth","isLoggedIn","user","level","realPermissionForEdit","edit","realPermissionForDel","del","_useSelector","search","key","value","data","_useState3","_useState4","filteredData","setFilteredData","useEffect","length","filter","d","toLowerCase","indexOf","toString","getHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","clearData","getData","then","catch","stop","apply","arguments","clearFilter","columnWithControl","concat","_toConsumableArray","title","render","item","_jsxs","Space","size","children","_jsx","Image","width","src","API_URL","image1","alt","image2","image3","EditTwoTone","className","onClick","id","showDrawer","show","Popconfirm","placement","onConfirm","removeData","message","error","open","type","content","okText","cancelText","DeleteTwoTone","twoToneColor","Switch","checkedChildren","unCheckedChildren","checked","status","style","marginLeft","onChange","addData","_objectSpread","onSwitch","Spin","spinning","Table","dataSource","CouponManage","tableColumns","coupon","searchFields","reduce","accumulator","currentValue","Row","justify","Search","fields","Button","icon","PlusOutlined","DataTable"],"sourceRoot":""}
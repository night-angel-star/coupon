{"version":3,"file":"static/js/390.19e153f1.chunk.js","mappings":"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","sources":["components/Tables/DataTable.jsx","pages/dashboard/LogView.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Table, Space, Popconfirm, message, Spin } from \"antd\";\r\nimport { EditTwoTone, DeleteTwoTone } from \"@ant-design/icons\";\r\nimport { useSelector } from \"react-redux\";\r\n// import { useLocation } from \"react-router-dom\";\r\nimport { removeData } from \"../../redux/actions/data\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { getData, clearData } from \"../../redux/actions/data\";\r\nimport { showDrawer } from \"../../redux/actions/drawer\";\r\nimport { clearFilter } from \"../../redux/actions/search\";\r\n\r\nconst EditableDataTable = (props) => {\r\n  const dispatch = useDispatch();\r\n  const [loading, setLoading] = useState(false);\r\n  const { columns, showAction } = props;\r\n  // const { pathname } = useLocation();\r\n  // const pageName = pathname.substring(1, pathname.length);\r\n  const pageName = useSelector((state) => state.route.name);\r\n  const permission = useSelector((state) =>\r\n    state.auth.isLoggedIn ? state.auth.user.permission : {}\r\n  );\r\n  const level = useSelector((state) =>\r\n    state.auth.isLoggedIn ? state.auth.user.level : -1\r\n  );\r\n\r\n  const realPermissionForEdit = permission[pageName]\r\n    ? permission[pageName].edit\r\n    : level;\r\n  const realPermissionForDel = permission[pageName]\r\n    ? permission[pageName].del\r\n    : level;\r\n  const { key, value } = useSelector((state) => state.search);\r\n\r\n  const data = useSelector((state) => state.data.data);\r\n  const [filteredData, setFilteredData] = useState(data);\r\n  useEffect(() => {\r\n    if (key.length > 0) {\r\n      setFilteredData(\r\n        data.filter((d) => {\r\n          if (d[key]) {\r\n            if (typeof d[key] === \"string\") {\r\n              return d[key].toLowerCase().indexOf(value.toLowerCase()) > -1\r\n                ? true\r\n                : false;\r\n            } else {\r\n              return d[key].toString() === value ? true : false;\r\n            }\r\n          } else {\r\n            return false;\r\n          }\r\n        })\r\n      );\r\n    } else {\r\n      setFilteredData(data);\r\n    }\r\n  }, [key, value, data]);\r\n\r\n  useEffect(() => {\r\n    if (pageName) {\r\n      setLoading(true);\r\n\r\n      const getHandler = async () => {\r\n        dispatch(clearData());\r\n        dispatch(getData(pageName))\r\n          .then(() => {\r\n            setLoading(false);\r\n          })\r\n          .catch(() => {\r\n            setLoading(false);\r\n          });\r\n      };\r\n      dispatch(clearFilter());\r\n      getHandler();\r\n    }\r\n  }, [dispatch, pageName]);\r\n\r\n  const editButtonHandler = (id) => {\r\n    dispatch(showDrawer({ id: id, title: `Edit ${pageName}`, show: true }));\r\n  };\r\n  const deleteButtonHandler = (id) => {\r\n    if (realPermissionForDel === 1) {\r\n      setLoading(true);\r\n      dispatch(removeData(pageName, { id }))\r\n        .then(() => setLoading(false))\r\n        .catch(() => {\r\n          message.error(\"Problem\");\r\n          setLoading(false);\r\n        });\r\n    } else {\r\n      message.open({ type: \"warning\", content: \"You have no permission\" });\r\n    }\r\n  };\r\n  const columnWithControl = [\r\n    ...columns,\r\n    {\r\n      title: \"Action\",\r\n      key: \"action\",\r\n      fixed: \"right\",\r\n      render: (item) => (\r\n        <Space size=\"middle\">\r\n          {realPermissionForEdit === 1 && (\r\n            <EditTwoTone\r\n              className=\"cursor-pointer\"\r\n              onClick={() => editButtonHandler(item.key)}\r\n            />\r\n          )}\r\n          <Popconfirm\r\n            placement=\"left\"\r\n            title=\"Sure to delete?\"\r\n            description=\"All levels and members below this level will be deleted.\"\r\n            onConfirm={() => deleteButtonHandler(item.key)}\r\n            okText=\"Yes\"\r\n            cancelText=\"No\"\r\n          >\r\n            {realPermissionForDel === 1 && (\r\n              <DeleteTwoTone\r\n                twoToneColor=\"#eb2f96\"\r\n                className=\"cursor-pointer\"\r\n              />\r\n            )}\r\n          </Popconfirm>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n  return (\r\n    <Spin spinning={loading}>\r\n      <Table\r\n        columns={showAction ? columnWithControl : columns}\r\n        dataSource={filteredData}\r\n      />\r\n    </Spin>\r\n  );\r\n};\r\nexport default EditableDataTable;\r\n","import DataTable from \"../../components/Tables/DataTable\";\r\nimport { Row, Space, DatePicker } from \"antd\";\r\nimport tableColumns from \"../../constant/tableColumns\";\r\nimport dayjs from \"dayjs\";\r\nimport moment from \"moment\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { getData } from \"../../redux/actions/data\";\r\n\r\nimport Search from \"../../components/Search\";\r\n\r\nconst dateFormat = \"YYYY-MM-DD\";\r\n\r\nconst { RangePicker } = DatePicker;\r\nexport const LogView = () => {\r\n  const dispatch = useDispatch();\r\n  const columns = tableColumns.log;\r\n  const searchFields = columns.reduce(\r\n    (accumulator, currentValue) => [...accumulator, currentValue.key],\r\n    []\r\n  );\r\n  const onPickData = async (value) => {\r\n    const start = value[0].format(dateFormat) + \" 00:00:00\";\r\n    const end = value[1].format(dateFormat) + \" 23:59:59\";\r\n    try {\r\n      await dispatch(getData(\"log\", `?from=${start}&to=${end}`));\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n  return (\r\n    <div>\r\n      <Row justify={\"end\"} className=\"p-2\">\r\n        <Space>\r\n          <RangePicker\r\n            defaultValue={[\r\n              dayjs(moment().format(\"YYYY-MM-DD\"), dateFormat),\r\n              dayjs(moment().format(\"YYYY-MM-DD\"), dateFormat),\r\n            ]}\r\n            onChange={onPickData}\r\n          />\r\n          <Search fields={searchFields} />\r\n        </Space>\r\n      </Row>\r\n      <DataTable columns={columns} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LogView;\r\n"],"names":["props","dispatch","useDispatch","_useState","useState","_useState2","_slicedToArray","loading","setLoading","columns","showAction","pageName","useSelector","state","route","name","permission","auth","isLoggedIn","user","level","realPermissionForEdit","edit","realPermissionForDel","del","_useSelector","search","key","value","data","_useState3","_useState4","filteredData","setFilteredData","useEffect","length","filter","d","toLowerCase","indexOf","toString","getHandler","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","clearData","getData","then","catch","stop","apply","arguments","clearFilter","columnWithControl","concat","_toConsumableArray","title","fixed","render","item","_jsxs","Space","size","children","_jsx","EditTwoTone","className","onClick","id","showDrawer","show","Popconfirm","placement","description","onConfirm","removeData","message","error","open","type","content","okText","cancelText","DeleteTwoTone","twoToneColor","Spin","spinning","Table","dataSource","dateFormat","RangePicker","DatePicker","LogView","tableColumns","log","searchFields","reduce","accumulator","currentValue","onPickData","start","end","format","t0","console","_x","Row","justify","defaultValue","dayjs","moment","onChange","Search","fields","DataTable"],"sourceRoot":""}